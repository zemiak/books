<?xml version="1.0" encoding="UTF-8"?>

<job id="metadata-job" xmlns="http://xmlns.jcp.org/xml/ns/javaee" version="1.0">
    <properties>
        <property name="fileList" value="/tmp/metadata-filelist"/>
    </properties>
    
    <listeners>
        <listener ref="com.zemiak.books.batch.metadata.Listener"/>
    </listeners>  
    
    <flow id="metadataFlow"> 
        <step id="prepare" next="run">
            <listeners>
                <listener ref="com.zemiak.books.batch.metadata.Listener"/>
            </listeners>
            <batchlet ref="com.zemiak.books.batch.metadata.PrepareFileList"></batchlet>
        </step>
        
        <step id="run" next="cleanup">
            <listeners>
                <listener ref="com.zemiak.books.batch.metadata.Listener"/>
            </listeners>
            
            <chunk item-count="1">
                <reader ref="com.zemiak.books.batch.metadata.Reader"></reader>
                <processor ref="com.zemiak.books.batch.metadata.Processor"></processor>
                <writer ref="com.zemiak.books.batch.metadata.Writer"></writer>
            </chunk>
        </step>
        
        <step id="cleanup" >
            <listeners>
                <listener ref="com.zemiak.books.batch.metadata.Listener"/>
            </listeners>
            <batchlet ref="com.zemiak.books.batch.metadata.RemoveFileList">
            </batchlet>
        </step>
    </flow>
</job>
